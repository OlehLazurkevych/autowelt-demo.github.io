---
layout: default
title: autowelt demo
---

<h1>Cars for Sale</h1>

<div class="controls">
  <label>
    Sort by:
    <select id="sort-select">
      <option value="price-asc">Price ↑</option>
      <option value="price-desc">Price ↓</option>
      <option value="year-desc">Year (newest)</option>
      <option value="year-asc">Year (oldest)</option>
    </select>
  </label>

  <label>
    Min year:
    <input type="number" id="filter-year-min" placeholder="e.g. 2015">
  </label>

  <label>
    Max price:
    <input type="number" id="filter-price-max" placeholder="e.g. 20000">
  </label>
</div>

<div id="cars-grid">
  {% assign cars = site.cars %}
  {% for car in cars %}
    {% assign cover = car.photos[0] | default: site.default_car_image %}
    <a class="car-card" href="{{ car.url | relative_url }}">

      <div class="car-card__imgwrap">
        <img class="car-card__img {% if car.under_deposit %}is-dimmed{% endif %}" src="{{ cover | relative_url }}" alt="{{ car.title | escape }}" loading="lazy">
        {% if car.under_deposit %}
          <div class="car-badge car-badge--deposit">UNDER DEPOSIT</div>
        {% endif %}
      </div>

      <div class="car-card__body">
        <div class="car-card__title">{{ car.title }}</div>
        {% if car.year %}
          <div class="car-meta">
            Year: {{ car.year }}
          </div>
        {% endif %}
        {% if car.engine %}
          <div class="car-meta">
            Year: {{ car.engine }}
          </div>
        {% endif %}
        {% if car.price_usd %}
          <div class="car-card__price">
            {{ car.price_usd }} $
          </div>
        {% endif %}
      </div>
    </a>
  {% endfor %}
</div>

<script>
  (function() {
    const grid = document.getElementById('cars-grid');
    const cards = Array.from(grid.querySelectorAll('.car-card'));
    const sortSelect = document.getElementById('sort-select');
    const yearMinInput = document.getElementById('filter-year-min');
    const priceMaxInput = document.getElementById('filter-price-max');

    function applyFiltersAndSort() {
      const minYear = parseInt(yearMinInput.value, 10) || 0;
      const maxPrice = parseInt(priceMaxInput.value, 10) || Infinity;
      const sortValue = sortSelect.value;

      let visible = cards.filter(card => {
        const year = parseInt(card.dataset.year || '0', 10);
        const price = parseInt(card.dataset.price || '0', 10);
        if (year && year < minYear) return false;
        if (price && price > maxPrice) return false;
        return true;
      });

      visible.sort((a, b) => {
        const ay = parseInt(a.dataset.year || '0', 10);
        const by = parseInt(b.dataset.year || '0', 10);
        const ap = parseInt(a.dataset.price || '0', 10);
        const bp = parseInt(b.dataset.price || '0', 10);

        switch (sortValue) {
          case 'price-asc':  return ap - bp;
          case 'price-desc': return bp - ap;
          case 'year-asc':   return ay - by;
          case 'year-desc':  return by - ay;
          default:           return 0;
        }
      });

      // Clear and re-append
      grid.innerHTML = '';
      visible.forEach(card => grid.appendChild(card));
    }

    [sortSelect, yearMinInput, priceMaxInput].forEach(el => {
      el.addEventListener('input', applyFiltersAndSort);
      el.addEventListener('change', applyFiltersAndSort);
    });

    // Initial sort
    applyFiltersAndSort();
  })();
</script>